{% extends 'home/base.html' %}
{% load crispy_forms_tags %}
{% load widget_tweaks %}

{% block site_title %} Upadte Issue {% endblock %}
{% block content %}
<div class="content-section content-section-single">
  <h3>Update Issue</h3>

  <div>
    <table>
      <tr>
        <th style="width: 15%;">ISSUE</th>
        <th>Date</th> 
        <th>Customer</th>
        <th>Machine S/N</th>
        <th>Machine, Model</th>
        <th style="width: 20%;">Problem</th>
        <th style="width: 30%;">Progress</th>
        <th>Executor</th>
        <th>Status</th>
        <th>Priority</th>
        {% if not user.is_superuser %}
          <th>edit</th>
          <th>delete</th>
        {% endif %}
      </tr>
    </table>
    {% for issue in issues %}
    <table>
      <tr>
        <td style="width: 15%;">{{ issue.issue |linebreaks}} </td>
        <td>{{ issue.date }} </td>
        <td>{{ issue.customer }} </td>
        <td>{{ issue.serial_no }} </td>
        <td>{{ issue.machine }},{{ issue.model }} </td>
        <td style="width: 20%;">{{ issue.problem |linebreaks}} </td>
        <td style="width: 30%;" >{{ issue.progress|linebreaks }} </td>
        <td>{{ issue.executor |capfirst}} </td>
        <td>{{ issue.status }} </td>
    {% if issue.priority == "HIGH" %}  
      <td style="background-color: #FFB3B3;">{{ issue.priority }} </td>
    {% elif issue.priority == "MEDIUM" %}
      <td style="background-color: #FFFFB3;">{{ issue.priority }} </td>
    {% elif issue.priority == "LOW" %}
      <td style="background-color: #B3FFB3;">{{ issue.priority }} </td>
    {% elif issue.priority == "LOAN PART" %} 
      <td style="background-color: #B3B3FF;">{{ issue.priority }} </td>
    {% endif %}
        {% if not user.is_superuser %}
        <td><a href="{% url 'edit_issue' issue.id %}">edit</a></td>
        <td><a href="{% url 'delete_issue' issue.id %}"><button class="button button-red" type="submit" onclick="return confirm('Are you sure?')">delete </button></a></td>
        {% endif %}
      </tr>
    </table>
    {% endfor %}
  </div>
  
  {% if last.status != 'closed'%}
  <form class="content-section content-section-single"  method="POST">   
    {% csrf_token %}
    {{form | crispy }} 

    <div>
      <button class="button button-primary" type="submit" >Update Issue</button>
    </div>
  </form>
  {% endif %}
  
</div>


{% endblock %}